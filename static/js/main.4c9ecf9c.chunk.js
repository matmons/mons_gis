(this["webpackJsonpreact-gis"]=this["webpackJsonpreact-gis"]||[]).push([[0],{241:function(e,t,r){"use strict";r.r(t);var n=r(110),i=r(111),a=r(123),c=r(120),o=r(3),s=r(1),d=r.n(s),l=r(17),j=r.n(l),u=(r(130),r(58)),b=r(11),O=r(81),f=r.n(O),h=r(113),x=r(248),p=r(59),y=r(13),m=r(247),v=r(250),g=r(252),L=r(121),k=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},C=function(e){var t=e.addLayer,r=Object(s.useState)(!1),n=Object(b.a)(r,2),i=n[0],a=n[1],c=function(){return a(!1)},d=function(){return a(!0)},l=Object(s.useCallback)((function(e){var r=new FileReader;r.onabort=function(){return console.log("Reading was aborted")},r.onerror=function(){return console.log("Reading has failed")},r.onload=function(){!function(e){var r=JSON.parse(e),n={id:r.name?r.name:Math.floor(1e3*Math.random()).toString(),data:r,addedToMap:!1,color:k()};t(n)}(r.result)},r.readAsText(e[0])}),[]),j=Object(L.a)({onDrop:l}),u=j.getRootProps,O=j.getInputProps,f=j.isDragActive;return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)(m.a,{children:[Object(o.jsx)(h.a,{md:1,children:Object(o.jsx)(y.i,{onClick:function(){return d()}})}),Object(o.jsx)(h.a,{md:7,onClick:function(){return d()},children:Object(o.jsx)("h5",{children:"Upload"})})]}),Object(o.jsxs)(v.a,{show:i,onHide:c,children:[Object(o.jsx)(v.a.Header,{closeButton:!0,children:Object(o.jsx)(v.a.Title,{children:"Upload"})}),Object(o.jsx)(v.a.Body,{children:Object(o.jsxs)("div",Object(p.a)(Object(p.a)({},u()),{},{children:[Object(o.jsx)("input",Object(p.a)({},O())),f?Object(o.jsx)("p",{children:"Drop the files here ..."}):Object(o.jsx)("p",{children:"Drag & drop files here or click to select files"})]}))}),Object(o.jsx)(v.a.Footer,{children:Object(o.jsx)(g.a,{variant:"secondary",onClick:c,children:"Close"})})]})]})},S=function(){return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)(m.a,{className:"strictRow",children:[Object(o.jsx)(h.a,{md:2,children:Object(o.jsx)(y.e,{size:32})}),Object(o.jsx)(h.a,{md:8,children:Object(o.jsx)("h2",{children:" Mons GIS "})}),Object(o.jsx)(h.a,{md:2})]})})},w=r(37),T=r(249),I=r(253),M=r(0),B=r(118),D=function(e){var t=e.map,r=e.layer,n=e.removeLayer,i=Object(s.useState)(r.color),a=Object(b.a)(i,2),c=a[0],d=a[1],l=Object(s.useState)("visible"),j=Object(b.a)(l,2),u=j[0],O=j[1],f=function(e){"visible"===t.getLayoutProperty(e,"visibility")?(t.setLayoutProperty(e,"visibility","none"),O("none")):(t.setLayoutProperty(e,"visibility","visible"),O("visible"))};return Object(o.jsxs)(m.a,{children:[Object(o.jsx)(h.a,{md:1}),Object(o.jsx)(h.a,{md:2,children:"visible"===u?Object(o.jsx)(y.c,{onClick:function(){f(r.id)}}):Object(o.jsx)(y.d,{onClick:function(){f(r.id)}})}),Object(o.jsx)(h.a,{md:4,children:r.id}),Object(o.jsx)(T.a,{trigger:"click",placement:"right",overlay:Object(o.jsxs)(I.a,{children:[Object(o.jsx)(I.a.Title,{as:"h3",children:"Change layer color"}),Object(o.jsx)(I.a.Content,{children:Object(o.jsx)(B.a,{color:c,onChangeComplete:function(e,n){d(e.hex),r.color=e.hex,t.setPaintProperty(r.id,"fill-color",e.hex)}})})]}),children:Object(o.jsx)(h.a,{md:2,children:Object(o.jsx)(M.b.Provider,{value:{color:c},children:Object(o.jsx)(y.b,{})})})},"right"),Object(o.jsx)(h.a,{md:2,children:Object(o.jsx)(y.g,{onClick:function(){return n(r.id)}})})]})},F=function(e){var t=e.map,r=e.layers,n=e.removeLayer,i=Object(s.useState)(!1),a=Object(b.a)(i,2),c=a[0],d=a[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)(m.a,{children:[Object(o.jsx)(h.a,{md:1,children:Object(o.jsx)(y.a,{onClick:function(){return d(!c)}})}),Object(o.jsx)(h.a,{md:7,onClick:function(){return d(!c)},children:Object(o.jsx)("h5",{children:"Layers"})}),Object(o.jsx)(h.a,{md:3,children:c?Object(o.jsx)(w.a,{size:20,onClick:function(){return d(!c)}}):Object(o.jsx)(w.b,{size:20,onClick:function(){return d(!c)}})})]}),c&&r.map((function(e){return Object(o.jsx)(D,{map:t,layer:e,removeLayer:n},e.id)}))]})},P=r(251),z=r(124),R=r(122),_=r(119),G=r(83),J=function(e){switch(e.type){case"FeatureCollection":return G.a.apply(void 0,Object(u.a)(e.features));case"Feature":default:return e}},U=function(e){var t=e.operation,r=e.layers,n=e.addLayer,i=Object(s.useState)({}),a=Object(b.a)(i,2),c=a[0],d=a[1],l=Object(s.useState)({}),j=Object(b.a)(l,2),u=j[0],O=j[1],f=Object(s.useState)(!1),x=Object(b.a)(f,2),p=x[0],L=x[1],C=function(){return L(!1)},S=function(){return L(!0)},w=function(e){switch(t.title){case"Buffer":var n=function(e,t){var r=Object(_.a)(e.data,t);return{id:"Buff_"+e.id,data:r,addedToMap:!1,color:k()}}(r.find((function(e){return e.id===c[t.layerList[0]]})),u.Radius);M(e,n);break;case"Intersect":var i=function(e,t){var r=J(e.data),n=J(t.data),i=Object(R.a)(r,n);return{id:"IS_"+e.id+"_"+t.id,data:i,addedToMap:!1,color:k()}}(r.find((function(e){return e.id===c[t.layerList[0]]})),r.find((function(e){return e.id===c[t.layerList[1]]})));M(e,i);break;case"Union":var a=function(e,t){var r=Object(G.a)(e.data,t.data);return{id:"Union_"+e.id+"_"+t.id,data:r,addedToMap:!1,color:k()}}(r.find((function(e){return e.id===c[t.layerList[0]]})),r.find((function(e){return e.id===c[t.layerList[1]]})));M(e,a);break;case"Difference":var o=function(e,t){var r=J(e.data),n=J(t.data);console.log(r,n);var i=Object(z.a)(r,n);return{id:"Diff_"+e.id+"_"+t.id,data:i,addedToMap:!1,color:k()}}(r.find((function(e){return e.id===c[t.layerList[0]]})),r.find((function(e){return e.id===c[t.layerList[1]]})));M(e,o);break;default:alert("Defaulted")}},M=function(e,t){t?n(t):alert("No area to subtract"),e.preventDefault(),d([])};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)(m.a,{children:[Object(o.jsx)(h.a,{md:2}),Object(o.jsx)(h.a,{md:6,onClick:S,children:t.title}),Object(o.jsx)(h.a,{md:3,onClick:S})]}),Object(o.jsxs)(v.a,{show:p,onHide:C,children:[Object(o.jsx)(v.a.Header,{closeButton:!0,children:Object(o.jsxs)(v.a.Title,{children:[t.title,Object(o.jsx)(T.a,{trigger:"hover",placement:"right",overlay:Object(o.jsxs)(I.a,{children:[Object(o.jsx)(I.a.Title,{as:"h3",children:"Help"}),Object(o.jsx)(I.a.Content,{children:t.description})]}),children:Object(o.jsx)(y.f,{style:{margin:4}})},"right")]})}),Object(o.jsx)(v.a.Body,{children:Object(o.jsxs)(P.a,{children:[t.layerList.map((function(e){return Object(o.jsxs)(P.a.Group,{controlId:e,children:[Object(o.jsxs)(P.a.Label,{children:["Select ",e]}),Object(o.jsxs)(P.a.Control,{as:"select",onChange:function(t){return d((function(r){return r[e]=t.target.value,c}))},required:!0,children:[Object(o.jsx)("option",{default:!0,value:null,children:"---"},"blank"),r.map((function(e){return Object(o.jsx)("option",{value:e.id,children:e.name?e.name:e.id},e.id)}))]})]},e)})),t.parameters&&Object.entries(t.parameters).map((function(e){var t=Object(b.a)(e,2),r=t[0],n=t[1];return Object(o.jsxs)(P.a.Group,{controlId:r.toString(),children:[Object(o.jsx)(P.a.Label,{children:r.toString()}),Object(o.jsx)(P.a.Control,{type:n,onChange:function(e){return O((function(t){return t[r]=e.target.value,t}))}})]},r)}))]})}),Object(o.jsxs)(v.a.Footer,{children:[Object(o.jsx)(g.a,{variant:"secondary",onClick:C,children:"Close"}),Object(o.jsx)(g.a,{variant:"primary",type:"submit",onClick:function(e){w(e),C()},children:"Add Layer"})]})]})]})},E=[{id:1,title:"Buffer",layerList:["Layer 1"],parameters:{Radius:"number"},description:"The Buffer Operation takes the features from a source vector layer and creates a buffer area of a specified distance around, storing the result on a Result Layer."},{id:2,title:"Intersect",layerList:["Layer 1","Layer 2"],parameters:{},description:"The Intersect Operation calculates the geometric intersection of two layers."},{id:3,title:"Union",layerList:["Layer 1","Layer 2"],parameters:{},description:"The Union Operation combines the features from two layers into a single, composite layer."},{id:4,title:"Difference",layerList:["Layer 1","Layer 2"],parameters:{},description:"The Difference Operation finds the difference between two polygons by clipping the second polygon from the first."}],H=function(e){var t=e.layers,r=e.addLayer,n=Object(s.useState)(!1),i=Object(b.a)(n,2),a=i[0],c=i[1];return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsxs)(m.a,{children:[Object(o.jsx)(h.a,{md:1,children:Object(o.jsx)(y.h,{})}),Object(o.jsx)(h.a,{md:7,onClick:function(){return c(!a)},children:Object(o.jsx)("h5",{children:"Operations"})}),Object(o.jsx)(h.a,{md:3,children:a?Object(o.jsx)(w.a,{size:20,onClick:function(){return c(!a)}}):Object(o.jsx)(w.b,{size:20,onClick:function(){return c(!a)}})})]}),a&&E.map((function(e){return Object(o.jsx)(U,{operation:e,layers:t,addLayer:r},e.id)}))]})},A={position:"absolute",top:0,left:0,width:"100%",background:"white",color:"black",padding:"1em",margin:10,zIndex:"1"},N=function(e){var t=e.map,r=e.layers,n=e.addLayer,i=e.removeLayer;return Object(o.jsx)(o.Fragment,{children:Object(o.jsx)(h.a,{md:3,children:Object(o.jsxs)(x.a,{style:A,children:[Object(o.jsx)(S,{}),Object(o.jsx)(H,{layers:r,addLayer:n}),Object(o.jsx)(F,{map:t,layers:r,removeLayer:i}),Object(o.jsx)(C,{addLayer:n})]})})})},V={position:"absolute",top:0,bottom:0,right:0,left:0,zIndex:"-1"},Z={position:"absolute",top:0,right:0,margin:10,padding:10,background:"white",zIndex:"1",display:"flex"},q=[{id:"streets-v11",name:"Streets"},{id:"light-v10",name:"Light"},{id:"dark-v10",name:"Dark"},{id:"satellite-v9",name:"Satellite"}];f.a.accessToken="pk.eyJ1IjoibW9uc2VtIiwiYSI6ImNraG4yc2syaTBiZ24ydGwxOTg0ZnJiMG0ifQ.B3OT7lkRhmt4w5lTa9fJ2w";var Q=function(){var e=Object(s.useState)(null),t=Object(b.a)(e,2),r=t[0],n=t[1],i=Object(s.useState)("streets-v11"),a=Object(b.a)(i,2),c=a[0],d=a[1],l=Object(s.useState)([]),j=Object(b.a)(l,2),O=j[0],h=j[1],x=Object(s.useRef)(null);Object(s.useEffect)((function(){r||function(e){var t=e.setMap,r=e.mapContainer,n=new f.a.Map({container:r.current,style:"mapbox://styles/mapbox/streets-v11",center:[10.3856,63.4292],zoom:12.2});n.on("load",(function(){t(n),n.resize()}))}({setMap:n,mapContainer:x}),r&&r.setStyle("mapbox://styles/mapbox/"+c)}),[c,r]),Object(s.useEffect)((function(){r&&O&&function(e,t){t.filter((function(e){return!e.addedToMap})).forEach((function(t){e.addSource(t.id,{type:"geojson",data:t.data}),e.addLayer({id:t.id,type:"fill",source:t.id,layout:{visibility:"visible"},paint:{"fill-color":t.color,"fill-opacity":.4}}),t.addedToMap=!0}))}(r,O)}),[O,r]);return Object(o.jsxs)("div",{children:[Object(o.jsx)(N,{map:r,layers:O,addLayer:function(e){h((function(t){return[].concat(Object(u.a)(t),[e])}))},removeLayer:function(e){r.removeLayer(e),r.removeSource(e),h((function(t){return t.filter((function(t){return t.id!==e}))}))},toggleVisibility:function(e){"visible"===r.getLayoutProperty(e,"visibility")?r.setLayoutProperty(e,"visibility","none"):r.setLayoutProperty(e,"visibility","visible")}}),Object(o.jsx)("div",{style:Z,children:q.map((function(e){return Object(o.jsxs)("div",{style:{margin:4},children:[Object(o.jsx)("input",{id:e.id,type:"radio",name:"rtoggle",value:e.id,onClick:function(){d(e.id),h([])},defaultChecked:e.id===c}),Object(o.jsx)("label",{style:{margin:2},children:e.name})]},e.id)}))}),Object(o.jsx)("div",{ref:function(e){return x.current=e},style:V})]})};var W=function(){return Object(o.jsx)("div",{children:Object(o.jsx)(Q,{})})},Y=function(e){Object(a.a)(r,e);var t=Object(c.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"render",value:function(){return Object(o.jsx)("div",{children:Object(o.jsx)(W,{})})}}]),r}(d.a.Component);j.a.render(Object(o.jsx)(Y,{}),document.getElementById("app"))}},[[241,1,2]]]);
//# sourceMappingURL=main.4c9ecf9c.chunk.js.map